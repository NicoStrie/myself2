<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Neon Racer - Nicolas Striebel</title>
<style>
  body {
    margin: 0;
    background: black;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    color: #0ff;
    font-family: 'Courier New', monospace;
  }
  canvas {
    border: 2px solid #0ff;
    background: linear-gradient(to bottom, #000, #111 40%, #000 100%);
  }
</style>
</head>
<body>
<canvas id="gameCanvas" width="500" height="700"></canvas>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
ctx.imageSmoothingEnabled = false;

let carName = prompt("Enter the name of your car:", "My Racer") || "My Racer";

let player = { x: 200, y: 600, width: 40, height: 80, speed: 40 };
let otherCars = [];
let coins = [];
let speed = 4;
let lastSpeedIncrease = Date.now();
let isGameOver = false;
let isGameStarted = false;
let speedUpMessageTimer = 0;

let roadColor = '#0ff';
let carColor = '#0ff';

const categories = [
  {name: 'Data Lake', color: '#ff0'},
  {name: 'GDPR', color: '#0f0'},
  {name: 'Cookie Banners', color: '#0ff'},
  {name: 'Dashboards', color: '#f0f'},
  {name: 'Reporting', color: '#f90'},
  {name: 'Attribution', color: '#09f'},
  {name: 'Data Strategy', color: '#f44'},
  {name: 'Floodlights', color: '#4f4'},
  {name: 'HTML', color: '#44f'},
  {name: 'Scoring Model', color: '#fa0'}
];
let categoryPoints = {};
categories.forEach(cat => categoryPoints[cat.name] = 0);

function drawPlayerCar() {
  ctx.fillStyle = carColor;
  ctx.fillRect(player.x, player.y, player.width, player.height);
  ctx.fillStyle = '#222';
  ctx.fillRect(player.x + 8, player.y + 10, player.width - 16, player.height - 20);
  ctx.fillStyle = '#0ff';
  ctx.font = '12px monospace';
  ctx.fillText(carName, player.x - 10, player.y - 5);
}

function spawnOtherCar() {
  if (otherCars.length < 3 && Math.random() < 0.02) {
    otherCars.push({
      x: Math.floor(Math.random() * (canvas.width - player.width)),
      y: -100,
      width: player.width,
      height: player.height,
      color: '#f0f'
    });
  }
}

function spawnCoin() {
  if (Math.random() < 0.02) {
    const cat = categories[Math.floor(Math.random() * categories.length)];
    coins.push({
      x: Math.random() * (canvas.width - 50),
      y: -40,
      size: 50,
      category: cat
    });
  }
}

document.addEventListener('keydown', e => {
  if (!isGameStarted && e.code === 'Space') {
    isGameStarted = true;
    update();
    return;
  }
  if (isGameOver && e.code === 'Space') {
    resetGame();
    return;
  }
  if (!isGameStarted) return;
  if (e.code === 'ArrowLeft') player.x = Math.max(0, player.x - player.speed);
  if (e.code === 'ArrowRight') player.x = Math.min(canvas.width - player.width, player.x + player.speed);
  if (e.code === 'ArrowUp') player.y = Math.max(0, player.y - player.speed);
  if (e.code === 'ArrowDown') player.y = Math.min(canvas.height - player.height, player.y + player.speed);
});

function update() {
  if (isGameOver) return;

  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawRoad();

  if (Date.now() - lastSpeedIncrease > 10000) {
    speed += 0.5;
    lastSpeedIncrease = Date.now();
    speedUpMessageTimer = 60; // show message for 60 frames
    roadColor = getRandomColor();
    carColor = getRandomColor();
  }

  drawPlayerCar();

  spawnOtherCar();
  otherCars.forEach((car, i) => {
    car.y += speed;
    ctx.fillStyle = car.color;
    ctx.fillRect(car.x, car.y, car.width, car.height);
    if (checkCollision(player, car)) endGame();
    if (car.y > canvas.height) otherCars.splice(i, 1);
  });

  spawnCoin();
  coins.forEach((coin, i) => {
    coin.y += speed;
    ctx.fillStyle = coin.category.color;
    ctx.beginPath();
    ctx.arc(coin.x + coin.size/2, coin.y + coin.size/2, coin.size/2, 0, Math.PI * 2);
    ctx.fill();
    ctx.fillStyle = '#0f0'; // green text
    ctx.font = '12px monospace';
    ctx.fillText(coin.category.name, coin.x + coin.size + 5, coin.y + coin.size/2 + 4);
    if (checkCollision(player, {x: coin.x, y: coin.y, width: coin.size, height: coin.size})) {
      categoryPoints[coin.category.name]++;
      coins.splice(i, 1);
    }
    if (coin.y > canvas.height) coins.splice(i, 1);
  });

  drawScoreCard();
  if (speedUpMessageTimer > 0) {
    ctx.fillStyle = '#ff0';
    ctx.font = '20px monospace';
    ctx.fillText('Speed Up!', 200, 50);
    speedUpMessageTimer--;
  }
  requestAnimationFrame(update);
}

function drawRoad() {
  ctx.strokeStyle = roadColor;
  ctx.lineWidth = 4;
  for (let y = 0; y < canvas.height; y += 40) {
    ctx.beginPath();
    ctx.moveTo(canvas.width/2, y);
    ctx.lineTo(canvas.width/2, y+20);
    ctx.stroke();
  }
}

function drawScoreCard() {
  ctx.fillStyle = 'rgba(0,0,0,0.5)';
  ctx.fillRect(5, 5, 200, 20 + categories.length * 15);
  ctx.fillStyle = '#0ff';
  ctx.font = '12px monospace';
  let y = 20;
  let total = 0;
  categories.forEach(cat => {
    ctx.fillText(`${cat.name}: ${categoryPoints[cat.name]}`, 10, y);
    total += categoryPoints[cat.name];
    y += 15;
  });
  ctx.fillText(`TOTAL: ${total}`, 10, y);
}

function checkCollision(a, b) {
  return a.x < b.x + b.width && a.x + a.width > b.x &&
         a.y < b.y + b.height && a.y + a.height > b.y;
}

function endGame() {
  isGameOver = true;
  ctx.fillStyle = 'rgba(0,0,0,0.8)';
  ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle = '#0ff';
  ctx.font = '20px monospace';
  ctx.fillText('GAME OVER', 180, 200);
  let y = 240;
  for (let cat in categoryPoints) {
    ctx.fillText(`${cat}: ${categoryPoints[cat]} points`, 50, y);
    y += 25;
  }
  ctx.fillText('Created with love by Nicolas Striebel', 30, y + 40);
  ctx.fillText('Press SPACE to restart', 120, y + 70);
  ctx.fillText('If you liked the game, kudos here:', 50, y + 110);
  ctx.fillText('Contact Me', 200, y + 130);
  ctx.fillText('Or browse my projects:', 50, y + 160);
  ctx.fillText('My Projects', 200, y + 180);

  canvas.addEventListener('click', function(evt) {
    const rect = canvas.getBoundingClientRect();
    const mouseX = evt.clientX - rect.left;
    const mouseY = evt.clientY - rect.top;
    if (mouseY > y + 115 && mouseY < y + 135) {
      window.open('https://nicostrie.github.io/myself2/contact.html', '_blank');
    }
    if (mouseY > y + 165 && mouseY < y + 185) {
      window.open('https://nicostrie.github.io/myself2/artificial-intelligence.html', '_blank');
    }
  });
}

function resetGame() {
  otherCars = [];
  coins = [];
  categories.forEach(cat => categoryPoints[cat.name] = 0);
  speed = 4;
  lastSpeedIncrease = Date.now();
  isGameOver = false;
  player.x = 200;
  player.y = 600;
  roadColor = '#0ff';
  carColor = '#0ff';
  update();
}

function getRandomColor() {
  const colors = ['#0ff', '#f0f', '#ff0', '#0f0', '#f90', '#09f', '#f44', '#44f'];
  return colors[Math.floor(Math.random() * colors.length)];
}

// Instructions screen
ctx.fillStyle = '#0ff';
ctx.font = '18px monospace';
ctx.fillText('NEON RACER - NICOLAS STRIEBEL', 80, 160);
ctx.fillText('Use LEFT/RIGHT to move sideways', 60, 200);
ctx.fillText('Use UP/DOWN to move forward/back', 60, 230);
ctx.fillText('Collect category coins for points', 60, 260);
ctx.fillText('Avoid other cars!', 160, 290);
ctx.fillText('Press SPACE to start', 140, 320);
</script>
</body>
</html>
